// Simplified server for testing purposes\nimport Fastify from 'fastify'\nimport cors from '@fastify/cors'\nimport staticFiles from '@fastify/static'\nimport path from 'path'\nimport { fileURLToPath } from 'url'\n\nconst __filename = fileURLToPath(import.meta.url)\nconst __dirname = path.dirname(__filename)\n\n// Create Fastify instance\nconst fastify = Fastify({\n  logger: {\n    level: 'info',\n    transport: {\n      target: 'pino-pretty',\n      options: {\n        colorize: true,\n        translateTime: 'HH:MM:ss Z',\n        ignore: 'pid,hostname'\n      }\n    }\n  }\n})\n\n// Enable CORS\nfastify.register(cors, {\n  origin: true\n})\n\n// Serve static files\nfastify.register(staticFiles, {\n  root: path.join(__dirname, '../public'),\n  prefix: '/'\n})\n\n// Health check endpoint\nfastify.get('/api/health', async (request, reply) => {\n  return {\n    status: 'healthy',\n    timestamp: new Date().toISOString(),\n    version: '2.0.0',\n    uptime: process.uptime()\n  }\n})\n\n// Simple computation endpoint for testing\nfastify.post('/api/compute', async (request, reply) => {\n  try {\n    const body = request.body as any\n    \n    // Extract parameters with defaults\n    const M = parseFloat(body.M || '2')\n    const typeModulation = body.typeModulation || 'PAM'\n    const SNR = parseFloat(body.SNR || '5.0')\n    const R = parseFloat(body.R || '0.5')\n    const N = parseFloat(body.N || '20')\n    const n = parseFloat(body.n || '128')\n    const threshold = parseFloat(body.threshold || '1e-6')\n    \n    // Simple calculation (placeholder)\n    const capacity_approx = Math.log2(1 + SNR)\n    let error_exponent = 0.01\n    \n    if (R < capacity_approx) {\n      error_exponent = Math.abs(capacity_approx - R) * 0.5\n    }\n    \n    const error_probability = Math.pow(2, -n * error_exponent)\n    const optimal_rho = 0.5 + Math.random() * 0.3\n    \n    return {\n      error_probability,\n      error_exponent,\n      optimal_rho,\n      computation_time_ms: 50 + Math.random() * 100,\n      cached: false\n    }\n  } catch (error) {\n    fastify.log.error('Computation error:', error)\n    reply.status(500)\n    return {\n      error: 'Computation Failed',\n      message: error instanceof Error ? error.message : 'Unknown error',\n      statusCode: 500\n    }\n  }\n})\n\n// Legacy endpoint for compatibility\nfastify.get('/api/exponents', async (request, reply) => {\n  try {\n    const query = request.query as any\n    \n    const M = parseFloat(query.M || '2')\n    const SNR = parseFloat(query.SNR || '1.0')\n    const R = parseFloat(query.R || '0.5')\n    const n = parseFloat(query.n || '128')\n    \n    // Simple calculation\n    const capacity_approx = Math.log2(1 + SNR)\n    let error_exponent = 0.01\n    \n    if (R < capacity_approx) {\n      error_exponent = Math.abs(capacity_approx - R) * 0.5\n    }\n    \n    const error_probability = Math.pow(2, -n * error_exponent)\n    const optimal_rho = 0.5 + Math.random() * 0.3\n    \n    return {\n      'Probabilidad de error': error_probability,\n      'error_exponent': error_exponent,\n      'rho Ã³ptima': optimal_rho\n    }\n  } catch (error) {\n    fastify.log.error('Legacy computation error:', error)\n    return `Error: ${error instanceof Error ? error.message : 'Unknown error'}`\n  }\n})\n\n// Catch-all route for SPA\nfastify.get('/*', async (request, reply) => {\n  return reply.sendFile('index.html')\n})\n\n// Start server\nasync function start() {\n  try {\n    const port = parseInt(process.env.PORT || '8000')\n    const host = process.env.HOST || '0.0.0.0'\n    \n    await fastify.listen({ port, host })\n    \n    console.log(`ðŸš€ EPCalculator v2 server listening on http://${host}:${port}`)\n    console.log(`ðŸ“– Health check available at http://${host}:${port}/api/health`)\n    \n  } catch (error) {\n    fastify.log.error('Failed to start server:', error)\n    process.exit(1)\n  }\n}\n\n// Handle graceful shutdown\nprocess.on('SIGTERM', async () => {\n  await fastify.close()\n  process.exit(0)\n})\n\nprocess.on('SIGINT', async () => {\n  await fastify.close()\n  process.exit(0)\n})\n\nstart()"
