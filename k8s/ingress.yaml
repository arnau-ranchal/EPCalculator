apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: epcalculator-ingress\n  namespace: epcalculator\n  labels:\n    app: epcalculator\n    component: ingress\n  annotations:\n    # Nginx ingress controller annotations\n    kubernetes.io/ingress.class: \"nginx\"\n    nginx.ingress.kubernetes.io/rewrite-target: /\n    nginx.ingress.kubernetes.io/ssl-redirect: \"true\"\n    nginx.ingress.kubernetes.io/force-ssl-redirect: \"true\"\n    \n    # Rate limiting for university environment\n    nginx.ingress.kubernetes.io/rate-limit: \"100\"\n    nginx.ingress.kubernetes.io/rate-limit-window: \"1m\"\n    nginx.ingress.kubernetes.io/rate-limit-response-code: \"429\"\n    \n    # Connection limits\n    nginx.ingress.kubernetes.io/limit-connections: \"10\"\n    nginx.ingress.kubernetes.io/limit-connections-response-code: \"503\"\n    \n    # Proxy settings for long computations\n    nginx.ingress.kubernetes.io/proxy-connect-timeout: \"60\"\n    nginx.ingress.kubernetes.io/proxy-send-timeout: \"60\"\n    nginx.ingress.kubernetes.io/proxy-read-timeout: \"60\"\n    nginx.ingress.kubernetes.io/proxy-body-size: \"10m\"\n    \n    # Security headers\n    nginx.ingress.kubernetes.io/configuration-snippet: |\n      add_header X-Frame-Options DENY always;\n      add_header X-Content-Type-Options nosniff always;\n      add_header X-XSS-Protection \"1; mode=block\" always;\n      add_header Referrer-Policy strict-origin-when-cross-origin always;\n      add_header Permissions-Policy \"geolocation=(), microphone=(), camera=()\" always;\n    \n    # University-specific annotations\n    university.upf.edu/project: \"epcalculator\"\n    university.upf.edu/group: \"matcom\"\n    university.upf.edu/access-level: \"public\"\n    \n    # Certificate management (adjust based on university setup)\n    cert-manager.io/cluster-issuer: \"university-ca-issuer\"\n    \n    # Enable gzip compression\n    nginx.ingress.kubernetes.io/enable-gzip: \"true\"\n    nginx.ingress.kubernetes.io/gzip-types: \"text/plain,text/css,application/json,application/javascript,text/xml,application/xml,application/xml+rss,text/javascript,application/wasm\"\nspec:\n  # TLS configuration (adjust based on university certificate setup)\n  tls:\n  - hosts:\n    - epcalculator.upf.edu\n    - epcalculator-dev.upf.edu\n    secretName: epcalculator-tls\n  \n  rules:\n  # Production domain\n  - host: epcalculator.upf.edu\n    http:\n      paths:\n      # API routes\n      - path: /api\n        pathType: Prefix\n        backend:\n          service:\n            name: epcalculator-backend\n            port:\n              number: 8000\n      \n      # Static files and SPA\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: epcalculator-frontend\n            port:\n              number: 80\n  \n  # Development domain (if needed)\n  - host: epcalculator-dev.upf.edu\n    http:\n      paths:\n      - path: /api\n        pathType: Prefix\n        backend:\n          service:\n            name: epcalculator-backend\n            port:\n              number: 8000\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: epcalculator-frontend\n            port:\n              number: 80\n\n---\n# Network policy for university security\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: epcalculator-network-policy\n  namespace: epcalculator\n  labels:\n    app: epcalculator\nspec:\n  podSelector:\n    matchLabels:\n      app: epcalculator\n  policyTypes:\n  - Ingress\n  - Egress\n  \n  ingress:\n  # Allow ingress from nginx ingress controller\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: ingress-nginx\n    ports:\n    - protocol: TCP\n      port: 8000\n  \n  # Allow ingress from same namespace\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: epcalculator\n    ports:\n    - protocol: TCP\n      port: 8000\n  \n  # Allow health checks from kube-system\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: kube-system\n    ports:\n    - protocol: TCP\n      port: 8000\n  \n  egress:\n  # Allow DNS resolution\n  - to: []\n    ports:\n    - protocol: UDP\n      port: 53\n    - protocol: TCP\n      port: 53\n  \n  # Allow HTTPS for external dependencies (if needed)\n  - to: []\n    ports:\n    - protocol: TCP\n      port: 443\n  \n  # Allow communication within namespace\n  - to:\n    - namespaceSelector:\n        matchLabels:\n          name: epcalculator\n\n---\n# Pod disruption budget for high availability\napiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: epcalculator-pdb\n  namespace: epcalculator\n  labels:\n    app: epcalculator\nspec:\n  minAvailable: 1\n  selector:\n    matchLabels:\n      app: epcalculator\n      component: backend"