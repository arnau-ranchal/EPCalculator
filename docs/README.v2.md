# EPCalculator v2 - Kubernetes-Native Transmission System Analysis Tool\n\n## Overview\n\nEPCalculator v2 is a complete redesign of the transmission system analysis tool, optimized for university server infrastructure and Kubernetes deployment. This version provides the same mathematical capabilities as the original while offering significant improvements in performance, scalability, and user experience.\n\n## Key Features\n\n### ğŸš€ **Performance & Architecture**\n- **Single-Pod Efficiency**: Optimized monolithic architecture for minimal resource usage\n- **WebAssembly Integration**: Near-native computation speed in the browser\n- **Progressive Web App**: Installable, offline-capable application\n- **Resource Optimization**: Designed for university server constraints\n\n### ğŸ¯ **Core Functionality**\n- Error probability calculations for digital transmission systems\n- Support for PAM, PSK, and QAM modulation schemes\n- Interactive plotting with D3.js visualization\n- Contour plot generation for multi-parameter analysis\n- Real-time computation with caching\n\n### ğŸ”§ **Technology Stack**\n- **Backend**: Fastify (Node.js) with TypeScript\n- **Frontend**: Svelte + TypeScript + Vite\n- **Database**: SQLite with better-sqlite3\n- **Computation**: WebAssembly (C++ to WASM)\n- **Containerization**: Docker with Alpine Linux\n- **Orchestration**: Kubernetes-native deployment\n\n## Architecture\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚                    Kubernetes Cluster                      â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚   Nginx Ingress â”‚  â”‚   LoadBalancer  â”‚  â”‚  Monitoring â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚              EPCalculator Pod(s)                       â”‚  â”‚\nâ”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚\nâ”‚  â”‚  â”‚ Svelte Frontend â”‚  â”‚    Fastify Backend          â”‚  â”‚  â”‚\nâ”‚  â”‚  â”‚                 â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚\nâ”‚  â”‚  â”‚ â€¢ TypeScript    â”‚  â”‚  â”‚    SQLite Database      â”‚ â”‚  â”‚  â”‚\nâ”‚  â”‚  â”‚ â€¢ WebAssembly   â”‚  â”‚  â”‚                         â”‚ â”‚  â”‚  â”‚\nâ”‚  â”‚  â”‚ â€¢ D3.js Plots   â”‚  â”‚  â”‚ â€¢ Computation Cache     â”‚ â”‚  â”‚  â”‚\nâ”‚  â”‚  â”‚ â€¢ PWA Features  â”‚  â”‚  â”‚ â€¢ Session Management    â”‚ â”‚  â”‚  â”‚\nâ”‚  â”‚  â”‚                 â”‚  â”‚  â”‚ â€¢ Analytics             â”‚ â”‚  â”‚  â”‚\nâ”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚\nâ”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚\nâ”‚  â”‚  Persistent     â”‚  â”‚   ConfigMaps    â”‚  â”‚   Secrets   â”‚  â”‚\nâ”‚  â”‚    Storage      â”‚  â”‚                 â”‚  â”‚             â”‚  â”‚\nâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n## Quick Start\n\n### Prerequisites\n- Docker 20.10+\n- Kubernetes 1.24+\n- kubectl configured\n- Node.js 20+ (for development)\n- Emscripten SDK (for WebAssembly compilation)\n\n### Development Setup\n\n1. **Clone and Install Dependencies**\n   ```bash\n   git clone <repository-url>\n   cd EPCalculator\n   npm install\n   ```\n\n2. **Build WebAssembly Module**\n   ```bash\n   ./scripts/build-wasm.sh\n   ```\n\n3. **Start Development Server**\n   ```bash\n   npm run dev\n   ```\n   - Backend: http://localhost:8000\n   - Frontend: http://localhost:3000\n   - API Docs: http://localhost:8000/docs\n\n### Production Deployment\n\n1. **Build and Deploy to Kubernetes**\n   ```bash\n   ./scripts/deploy-k8s.sh deploy\n   ```\n\n2. **Check Deployment Status**\n   ```bash\n   ./scripts/deploy-k8s.sh status\n   ```\n\n3. **Update Deployment**\n   ```bash\n   ./scripts/deploy-k8s.sh update\n   ```\n\n## Configuration\n\n### Environment Variables\n\n| Variable | Default | Description |\n|----------|---------|-------------|\n| `NODE_ENV` | `production` | Environment mode |\n| `PORT` | `8000` | Server port |\n| `DATABASE_PATH` | `./data/epcalculator.db` | SQLite database path |\n| `MAX_USERS` | `50` | Maximum concurrent users |\n| `UNIVERSITY_NAME` | `UPF` | University identifier |\n| `RATE_LIMIT_MAX` | `100` | Requests per minute limit |\n| `ENABLE_COMPUTATION_CACHE` | `true` | Enable result caching |\n\n### University-Specific Settings\n\nThe application is configured for university environments with:\n- Resource constraints (512MB memory, 500m CPU)\n- User limits (50 concurrent users)\n- Network restrictions and security policies\n- Monitoring and analytics for academic use\n\n## API Documentation\n\n### Core Endpoints\n\n#### Computation\n```bash\n# Single computation\nPOST /api/compute\n{\n  \"M\": 4,\n  \"typeModulation\": \"PAM\",\n  \"SNR\": 5.0,\n  \"R\": 0.5,\n  \"N\": 20,\n  \"n\": 128,\n  \"threshold\": 1e-6\n}\n\n# Batch computation\nPOST /api/compute/batch\n{\n  \"parameters\": [/* array of computation parameters */]\n}\n```\n\n#### Plotting\n```bash\n# Generate plot data\nPOST /api/plot\n{\n  \"y\": \"error_probability\",\n  \"x\": \"SNR\",\n  \"x_range\": [0, 20],\n  \"points\": 50,\n  /* ... other parameters */\n}\n\n# Generate contour plot\nPOST /api/contour\n{\n  \"y\": \"error_probability\",\n  \"x1\": \"SNR\",\n  \"x2\": \"R\",\n  \"x1_range\": [0, 20],\n  \"x2_range\": [0.1, 0.9],\n  /* ... other parameters */\n}\n```\n\n#### Health & Analytics\n```bash\n# Health check\nGET /api/health\n\n# Analytics data\nGET /api/analytics\n\n# System status\nGET /api/analytics/system\n```\n\n## Features\n\n### ğŸ§® **Advanced Computations**\n- **Error Probability**: Calculate transmission error rates\n- **Error Exponent**: Determine exponential decay rates\n- **Optimal Rho**: Find optimal parameter values\n- **Batch Processing**: Multiple parameter sets simultaneously\n- **WebAssembly Acceleration**: Near-native performance\n\n### ğŸ“Š **Visualization**\n- **Interactive Plots**: Real-time parameter adjustment\n- **Multiple Plot Types**: Line plots, contour plots, 3D surfaces\n- **Export Options**: PNG, SVG, PDF formats\n- **Responsive Design**: Works on desktop, tablet, and mobile\n\n### ğŸ’¾ **Data Management**\n- **Session Persistence**: Maintain user state across visits\n- **Computation History**: Track and replay previous calculations\n- **Result Caching**: Intelligent caching for performance\n- **Offline Support**: PWA capabilities for offline use\n\n### ğŸ”’ **Security & Monitoring**\n- **Rate Limiting**: Prevent abuse and ensure fair usage\n- **Input Validation**: Comprehensive parameter validation\n- **Usage Analytics**: Track university usage patterns\n- **Health Monitoring**: Real-time system health checks\n\n## Performance Optimizations\n\n### University Server Optimizations\n- **Memory Efficiency**: <512MB per pod\n- **CPU Optimization**: Burst-capable with 200m base\n- **Storage Optimization**: Local SSD with compression\n- **Network Optimization**: Gzip compression, HTTP/2\n\n### Frontend Optimizations\n- **Bundle Splitting**: Separate vendor and app code\n- **Lazy Loading**: Load components on demand\n- **Image Optimization**: WebP with fallbacks\n- **Service Worker**: Intelligent caching strategy\n\n### Backend Optimizations\n- **Connection Pooling**: Efficient database connections\n- **Query Optimization**: Indexed database queries\n- **Computation Caching**: Redis-compatible memory cache\n- **Async Processing**: Non-blocking I/O operations\n\n## Monitoring\n\n### Built-in Monitoring\n- **Health Endpoints**: Kubernetes-compatible probes\n- **Performance Metrics**: Core Web Vitals tracking\n- **Usage Analytics**: User behavior and system usage\n- **Error Tracking**: Comprehensive error logging\n\n### Prometheus Integration\n```yaml\n# ServiceMonitor example\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: epcalculator-monitor\nspec:\n  selector:\n    matchLabels:\n      app: epcalculator\n  endpoints:\n  - port: metrics\n    path: /api/analytics\n```\n\n### Grafana Dashboard\nA pre-configured dashboard is available in `/k8s/monitoring.yaml` with:\n- Active user count\n- Computation performance metrics\n- Memory and CPU usage\n- Error rates and response times\n\n## Troubleshooting\n\n### Common Issues\n\n1. **WebAssembly Not Loading**\n   ```bash\n   # Check WASM files are built\n   ls public/wasm/\n   \n   # Rebuild if missing\n   ./scripts/build-wasm.sh\n   ```\n\n2. **Database Connection Errors**\n   ```bash\n   # Check database directory permissions\n   kubectl exec -it <pod-name> -- ls -la /app/data\n   \n   # Recreate if needed\n   kubectl delete pvc epcalculator-data\n   kubectl apply -f k8s/storage.yaml\n   ```\n\n3. **High Memory Usage**\n   ```bash\n   # Check memory usage\n   kubectl top pods -n epcalculator\n   \n   # Restart if needed\n   kubectl rollout restart deployment/epcalculator -n epcalculator\n   ```\n\n### Debug Commands\n```bash\n# View logs\nkubectl logs -f deployment/epcalculator -n epcalculator\n\n# Port forward for local access\nkubectl port-forward svc/epcalculator-frontend 8080:80 -n epcalculator\n\n# Shell into pod\nkubectl exec -it <pod-name> -n epcalculator -- /bin/sh\n\n# Check resource usage\nkubectl describe pod <pod-name> -n epcalculator\n```\n\n## Migration from v1\n\n### API Compatibility\nThe v2 API maintains backward compatibility with v1:\n- Legacy `/exponents` endpoint still works\n- Same parameter names and formats\n- Compatible response structures\n\n### Data Migration\n```bash\n# Export v1 data (if needed)\npython3 scripts/export-v1-data.py\n\n# Import to v2 database\nnode scripts/import-data.js v1-export.json\n```\n\n## Contributing\n\n### Development Workflow\n1. Create feature branch from `main`\n2. Implement changes with tests\n3. Run quality checks: `npm run lint && npm run test`\n4. Build and test: `npm run build`\n5. Submit pull request\n\n### Code Style\n- TypeScript with strict mode\n- ESLint + Prettier configuration\n- Conventional commit messages\n- 80% test coverage minimum\n\n## License\n\nMIT License - see LICENSE file for details.\n\n## Support\n\n- **Documentation**: `/docs` directory\n- **Issues**: GitHub Issues\n- **University Support**: Contact UPF MatCom Research Group\n- **Email**: matcom@upf.edu\n\n---\n\n**EPCalculator v2** - *Efficient, Scalable, University-Ready*\n\n*Â© 2025 UPF MatCom Research Group*"